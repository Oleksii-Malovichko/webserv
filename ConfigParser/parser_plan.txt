–û—Ç–ª–∏—á–Ω–æ, –≤–æ—Ç **—Å —ç—Ç–æ–≥–æ –º–µ—Å—Ç–∞** —Ä–µ–∞–ª—å–Ω–æ –∏ –Ω—É–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å üëç
–°–µ–π—á–∞—Å –¥–∞–º —Ç–µ–±–µ **—á—ë—Ç–∫–∏–π, –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω**, **–±–µ–∑ –∫–æ–¥–∞**, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –±—É–∫–≤–∞–ª—å–Ω–æ –¥–µ—Ä–∂–∞—Ç—å —Ä—è–¥–æ–º –∏ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø—É–Ω–∫—Ç –∑–∞ –ø—É–Ω–∫—Ç–æ–º.

–ú—ã –ø–æ–π–¥—ë–º **–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É**, —á—Ç–æ–±—ã —Ç—ã –Ω–µ —É—Ç–æ–Ω—É–ª.

---

# –û–ë–©–ê–Ø –ò–î–ï–Ø (1 –∞–±–∑–∞—Ü)

–¢–≤–æ–π `ConfigParser` ‚Äî —ç—Ç–æ **–ø–æ—à–∞–≥–æ–≤—ã–π –∞–≤—Ç–æ–º–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–π**, –∫–æ—Ç–æ—Ä—ã–π:

* —á–∏—Ç–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª
* –ø–æ–Ω–∏–º–∞–µ—Ç, *–≤ –∫–∞–∫–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–Ω —Å–µ–π—á–∞—Å* (`GLOBAL / SERVER / LOCATION`)
* –ø–æ –∏–º–µ–Ω–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –≤—ã–∑—ã–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
* –Ω–∞ –≤—ã—Ö–æ–¥–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–∞–ª–∏–¥–Ω—ã–π `WebServConfig`

---

# –®–ê–ì 0 ‚Äî –æ–ø—Ä–µ–¥–µ–ª–∏—Å—å —Å –±–∞–∑–æ–≤—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ (–º—ã—Å–ª–µ–Ω–Ω–æ)

–ü–µ—Ä–µ–¥ –∫–æ–¥–æ–º —Ç—ã –¥–æ–ª–∂–µ–Ω **–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞**:

* –¥–∏—Ä–µ–∫—Ç–∏–≤—ã **–Ω–µ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø–æ—Ä—è–¥–∫–∞**
* `server {}` ‚Äî –≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
* `location {}` ‚Äî —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ `server`
* `;` –∑–∞–≤–µ—Ä—à–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–∏–≤—É
* `{` –∏ `}` —É–ø—Ä–∞–≤–ª—è—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
* –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ `#` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

–≠—Ç–æ —Ç–≤–æ—è ¬´—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è¬ª.

---

# –®–ê–ì 1 ‚Äî –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª –∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –µ–≥–æ –≤ —É–¥–æ–±–Ω—ã–π –≤–∏–¥

–¶–µ–ª—å: **–ø–æ–ª—É—á–∏—Ç—å –ø–æ—Ç–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤**, –∞ –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏.

–õ–æ–≥–∏—á–µ—Å–∫–∏:

* –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª
* —á–∏—Ç–∞—Ç—å –ø–æ—Å—Ç—Ä–æ—á–Ω–æ
* —É–±—Ä–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
* –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã
* —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã:

  * `{`, `}`, `;` –±—ã–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏

üëâ –†–µ–∑—É–ª—å—Ç–∞—Ç: –ª–∏–Ω–µ–π–Ω—ã–π –ø–æ—Ç–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
server { listen 8080 ; root ./www ; location / { ... } }
```

---

# –®–ê–ì 2 ‚Äî –∑–∞–≤–µ—Å—Ç–∏ –ø–æ–Ω—è—Ç–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–¢–µ–±–µ –Ω—É–∂–µ–Ω **—Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç**:

* `GLOBAL`
* `SERVER`
* `LOCATION`

–ò —Å—Ç–µ–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ (–∏–ª–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç).

–ü–∞—Ä—Å–µ—Ä **–≤—Å–µ–≥–¥–∞** –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å:

> ¬´–≥–¥–µ —è —Å–µ–π—á–∞—Å?¬ª

---

# –®–ê–ì 3 ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –ø–∞—Ä—Å–∏–Ω–≥–∞

–¢—ã –¥–µ–ª–∞–µ—à—å **–æ–¥–∏–Ω –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª**, –∫–æ—Ç–æ—Ä—ã–π –∏–¥—ë—Ç –ø–æ —Ç–æ–∫–µ–Ω–∞–º.

–ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:

1. —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ —Ç–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω
2. —Å–º–æ—Ç—Ä–∏—à—å –Ω–∞ —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
3. –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ—à–µ–Ω–∏–µ, —á—Ç–æ –¥–µ–ª–∞—Ç—å

–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ (—Å–ª–æ–≤–∞–º–∏):

* `server` –≤ `GLOBAL` ‚Üí –Ω–∞—á–∞—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
* `{` ‚Üí –≤–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
* `}` ‚Üí –≤—ã–π—Ç–∏ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
* `location` –≤ `SERVER` ‚Üí –Ω–∞—á–∞—Ç—å location
* –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ ‚Üí –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ –∏–º–µ–Ω–∏

---

# –®–ê–ì 4 ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ `server {}`

–ö–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—Ç–∏–ª `server`:

1. **—Ä–∞–∑—Ä–µ—à–µ–Ω–æ —Ç–æ–ª—å–∫–æ –≤ `GLOBAL`**
2. —Å–æ–∑–¥–∞—ë—à—å –Ω–æ–≤—ã–π `ServerConfig`
3. –æ–∂–∏–¥–∞–µ—à—å `{`
4. –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—à—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ `SERVER`
5. –Ω–∞—á–∏–Ω–∞–µ—à—å —á–∏—Ç–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤—ã —Å–µ—Ä–≤–µ—Ä–∞

–í–∞–∂–Ω–æ:

* —Ç—ã **–Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—à—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è —Å—Ä–∞–∑—É**
* —Ç—ã **–ø—Ä–æ—Å—Ç–æ –∑–∞–ø–æ–ª–Ω—è–µ—à—å**

---

# –®–ê–ì 5 ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤ —Å–µ—Ä–≤–µ—Ä–∞

–í–Ω—É—Ç—Ä–∏ `SERVER`:

* `listen` ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ—Ä—Ç
* `root` ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å root
* `error_page` ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
* `client_max_body_size` ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å
* `location` ‚Üí –ø–µ—Ä–µ–π—Ç–∏ –∫ –æ–±—Ä–∞–±–æ—Ç–∫–µ location

–ö–∞–∂–¥–∞—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞:

* –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç—å –≤ `SERVER`
* –∏–º–µ–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–µ —á–∏—Å–ª–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
* –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è `;`

---

# –®–ê–ì 6 ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ `location {}`

–ö–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—Ç–∏–ª `location`:

1. —Ä–∞–∑—Ä–µ—à–µ–Ω–æ **—Ç–æ–ª—å–∫–æ –≤ `SERVER`**
2. —á–∏—Ç–∞–µ—à—å –ø—É—Ç—å (`/`, `/upload`, `/cgi-bin`)
3. —Å–æ–∑–¥–∞—ë—à—å `LocationConfig`
4. –æ–∂–∏–¥–∞–µ—à—å `{`
5. –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—à—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ `LOCATION`

---

# –®–ê–ì 7 ‚Äî –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –≤–Ω—É—Ç—Ä–∏ location

–í `LOCATION` —Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å:

* `methods`
* `index`
* `autoindex`
* `upload`
* `cgi`
* `root` (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—à—å override)

–ü—Ä–∞–≤–∏–ª–∞:

* `listen` —Ç—É—Ç **–∑–∞–ø—Ä–µ—â—ë–Ω**
* –∫–∞–∂–¥–∞—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è
* –ø–æ—Ä—è–¥–æ–∫ –Ω–µ –≤–∞–∂–µ–Ω

---

# –®–ê–ì 8 ‚Äî –≤—ã—Ö–æ–¥ –∏–∑ –±–ª–æ–∫–æ–≤ (`}`)

–û—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç.

–ö–æ–≥–¥–∞ —Ç—ã –≤—Å—Ç—Ä–µ—á–∞–µ—à—å `}`:

* –µ—Å–ª–∏ —Ç—ã –≤ `LOCATION`:

  * –≤–∞–ª–∏–¥–∏—Ä—É–µ—à—å `LocationConfig`
  * –¥–æ–±–∞–≤–ª—è–µ—à—å –µ–≥–æ –≤ —Ç–µ–∫—É—â–∏–π `ServerConfig`
  * –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è –≤ `SERVER`
* –µ—Å–ª–∏ —Ç—ã –≤ `SERVER`:

  * –≤–∞–ª–∏–¥–∏—Ä—É–µ—à—å `ServerConfig`
  * –¥–æ–±–∞–≤–ª—è–µ—à—å –µ–≥–æ –≤ `WebServConfig`
  * –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å—Å—è –≤ `GLOBAL`
* –µ—Å–ª–∏ —Ç—ã –≤ `GLOBAL` ‚Üí –æ—à–∏–±–∫–∞

---

# –®–ê–ì 9 ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

–ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ñ–∞–π–ª–∞:

* –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `GLOBAL`
* –≤—Å–µ `{` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç—ã
* `WebServConfig` –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å ‚â• 1 server
* –∫–∞–∂–¥—ã–π `ServerConfig` –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å:

  * `listen`
  * `root`

---

# –®–ê–ì 10 ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü–∞—Ä—Å–µ—Ä **–æ–±—è–∑–∞–Ω –ø–∞–¥–∞—Ç—å**, –µ—Å–ª–∏:

* –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
* –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞
* –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤
* –ª–∏—à–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã
* –Ω–µ—Ç `;`
* `{` / `}` –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç
* –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ –Ω–µ –∑–∞–¥–∞–Ω–æ

–ò **–Ω–µ –ø–∞–¥–∞—Ç—å**, –µ—Å–ª–∏:

* –¥—Ä—É–≥–æ–π –ø–æ—Ä—è–¥–æ–∫ –¥–∏—Ä–µ–∫—Ç–∏–≤
* –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏
* –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
* –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã

---

# –®–ê–ì 11 ‚Äî —á—Ç–æ —Ç—ã –ø–æ–ª—É—á–∏—à—å –Ω–∞ –≤—ã—Ö–æ–¥–µ

–ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã–π –æ–±—ä–µ–∫—Ç:

```
WebServConfig
 ‚îú‚îÄ‚îÄ ServerConfig (8080)
 ‚îÇ    ‚îú‚îÄ‚îÄ root ./www
 ‚îÇ    ‚îú‚îÄ‚îÄ error_page 404 ...
 ‚îÇ    ‚îî‚îÄ‚îÄ LocationConfig (/)
 ‚îî‚îÄ‚îÄ ServerConfig (8081)
```

–ò `Server` –ø—Ä–æ—Å—Ç–æ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

---

# –° –ß–ï–ì–û –ù–ê–ß–ê–¢–¨ –ü–†–Ø–ú–û –°–ï–ô–ß–ê–°

–ï—Å–ª–∏ —Å–æ–≤—Å–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ:

1Ô∏è‚É£ —Ä–µ–∞–ª–∏–∑—É–π **—á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ + —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤**
2Ô∏è‚É£ —Å–¥–µ–ª–∞–π **—Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é** (`{ } ;` –æ—Ç–¥–µ–ª—å–Ω–æ)
3Ô∏è‚É£ –∑–∞–≤–µ–¥–∏ **enum Context**
4Ô∏è‚É£ —Å–¥–µ–ª–∞–π **—Ü–∏–∫–ª –ø–æ —Ç–æ–∫–µ–Ω–∞–º**
5Ô∏è‚É£ –Ω–∞—É—á–∏ –µ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å `server {}`

–í–°–Å. –û—Å—Ç–∞–ª—å–Ω–æ–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ.

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –º–æ–∂–µ–º:

* —Ä–∞–∑–æ–±—Ä–∞—Ç—å **—Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é –ø–æ–¥—Ä–æ–±–Ω–æ**
* —Å–æ—Å—Ç–∞–≤–∏—Ç—å **—Ç–∞–±–ª–∏—Ü—É –¥–∏—Ä–µ–∫—Ç–∏–≤ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤**
* —Ä–∞–∑–æ–±—Ä–∞—Ç—å **—Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ª–æ–≤—è—Ç –Ω–∞ –∑–∞—â–∏—Ç–µ**
* –∏–ª–∏ –ø—Ä–æ–π—Ç–∏ **—Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ —Ç–æ–∫–µ–Ω –∑–∞ —Ç–æ–∫–µ–Ω–æ–º**

–°–∫–∞–∂–∏, —á—Ç–æ –¥–∞–ª—å—à–µ ‚Äî —Ç—ã –≤ –æ—Ç–ª–∏—á–Ω–æ–π —Ç–æ—á–∫–µ —Å—Ç–∞—Ä—Ç–∞ üí™
